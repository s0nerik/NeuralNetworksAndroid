#include <vector>
#include <iostream>
#include "LearningResult.h"
#include "NetworkTrainer.h"

using namespace std;

int main()
{
    vector<vector<double>> trainingSets = {
            {0.13930348258706468,0.1791044776119403,0.08955223880597014,0.07303482587064676,0.04776119402985075,0.01990049751243781},
            {0.024875621890547265,0.05970149253731343,0.01990049751243781,0.023880597014925373,0.04378109452736319,0.04378109452736319},
            {0.08955223880597014,0.25870646766169153,0.006567164179104478,0.009950248756218905,0.11940298507462686,0.06965174129353234},
            {0.0318407960199005,0.01990049751243781,0.09950248756218906,0.09293532338308458,0.06965174129353234,0.01990049751243781},
            {0.04378109452736319,0.029850746268656716,0.024875621890547265,0.08955223880597014,0.01990049751243781,0.05313432835820896},
            {0.003980099502487563,0.04975124378109453,0.13930348258706468,0.01990049751243781,0.12935323383084577,0.006567164179104478},
            {0.029850746268656716,0.07960199004975124,0.0662686567164179,0.029850746268656716,0.13930348258706468,0.27860696517412936},
            {0.04975124378109453,0.0662686567164179,0.07462686567164178,0.10945273631840796,0.25870646766169153,0.05472636815920398},
            {0.14925373134328357,0.12935323383084577,0.09950248756218906,0.23880597014925373,0.07960199004975124,0.029850746268656716},
            {0.023880597014925373,0.01990049751243781,0.03980099502487562,0.0463681592039801,0.19900497512437812,0.09950248756218906},
            {0.03582089552238806,0.04776119402985075,0.05970149253731343,0.029850746268656716,0.014925373134328358,0.07303482587064676},
            {0.14925373134328357,0.03980099502487562,0.0463681592039801,0.04378109452736319,0.07462686567164178,0.25870646766169153},
            {0.11940298507462686,0.03582089552238806,0.03482587064676617,0.27860696517412936,0.009950248756218905,0.09950248756218906},
            {0.05970149253731343,0.004975124378109453,0.29850746268656714,0.055721393034825865,0.02646766169154229,0.04975124378109453},
            {0.01990049751243781,0.05313432835820896,0.09950248756218906,0.027860696517412933,0.08955223880597014,0.03980099502487562},
            {0.029850746268656716,0.03980099502487562,0.09950248756218906,0.003980099502487563,0.10945273631840796,0.06965174129353234},
            {0.04776119402985075,0.05313432835820896,0.01990049751243781,0.02646766169154229,0.03482587064676617,0.11940298507462686},
            {0.12935323383084577,0.07462686567164178,0.27860696517412936,0.01990049751243781,0.07960199004975124,0.024875621890547265},
            {0.29850746268656714,0.05970149253731343,0.05970149253731343,0.03582089552238806,0.011940298507462687,0.13930348258706468},
            {0.10945273631840796,0.05970149253731343,0.19900497512437812,0.03980099502487562,0.15920398009950248,0.11940298507462686},
            {0.05970149253731343,0.03980099502487562,0.07462686567164178,0.05970149253731343,0.055721393034825865,0.07303482587064676},
            {0.03980099502487562,0.01592039800995025,0.009950248756218905,0.0463681592039801,0.05970149253731343,0.03582089552238806},
            {0.011940298507462687,0.006567164179104478,0.07960199004975124,0.027860696517412933,0.05313432835820896,0.009950248756218905},
            {0.003980099502487563,0.01990049751243781,0.08955223880597014,0.029850746268656716,0.07303482587064676,0.13930348258706468},
            {0.009950248756218905,0.055721393034825865,0.029850746268656716,0.07960199004975124,0.03980099502487562,0.05970149253731343},
            {0.19900497512437812,0.10945273631840796,0.11940298507462686,0.07960199004975124,0.06965174129353234,0.007960199004975126},
            {0.08616915422885572,0.05970149253731343,0.0318407960199005,0.07960199004975124,0.013333333333333334,0.11940298507462686},
            {0.0463681592039801,0.01990049751243781,0.01990049751243781,0.006567164179104478,0.04378109452736319,0.25870646766169153},
            {0.014925373134328358,0.07960199004975124,0.003980099502487563,0.25870646766169153,0.09293532338308458,0.011940298507462687},
            {0.023880597014925373,0.01990049751243781,0.06965174129353234,0.23880597014925373,0.03980099502487562,0.01990049751243781},
            {0.027860696517412933,0.01990049751243781,0.01592039800995025,0.03980099502487562,0.023880597014925373,0.007960199004975126},
            {0.14925373134328357,0.003980099502487563,0.14925373134328357,0.13930348258706468,0.07960199004975124,0.06965174129353234},
            {0.07960199004975124,0.14925373134328357,0.04776119402985075,0.009950248756218905,0.04378109452736319,0.009950248756218905},
            {0.13930348258706468,0.07303482587064676,0.05970149253731343,0.03980099502487562,0.01592039800995025,0.03980099502487562},
            {0.04378109452736319,0.11940298507462686,0.11940298507462686,0.15920398009950248,0.07960199004975124,0.05970149253731343},
            {0.09950248756218906,0.21890547263681592,0.01990049751243781,0.06965174129353234,0.05970149253731343,0.19900497512437812},
            {0.029850746268656716,0.06467661691542288,0.1791044776119403,0.11940298507462686,0.0662686567164179,0.0463681592039801},
            {0.05174129353233831,0.08955223880597014,0.04975124378109453,0.03980099502487562,0.12935323383084577,0.08955223880597014},
            {0.05970149253731343,0.05970149253731343,0.27860696517412936,0.03582089552238806,0.0662686567164179,0.23880597014925373},
            {0.027860696517412933,0.01990049751243781,0.01592039800995025,0.0662686567164179,0.04477611940298507,0.0318407960199005},
            {0.05970149253731343,0.06965174129353234,0.01990049751243781,0.0463681592039801,0.011940298507462687,0.13930348258706468},
            {0.011940298507462687,0.009950248756218905,0.006567164179104478,0.027860696517412933,0.08616915422885572,0.07462686567164178},
            {0.03482587064676617,0.06467661691542288,0.03980099502487562,0.03980099502487562,0.01990049751243781,0.07960199004975124},
            {0.27860696517412936,0.03980099502487562,0.11940298507462686,0.09950248756218906,0.007960199004975126,0.04975124378109453},
            {0.06467661691542288,0.04477611940298507,0.09293532338308458,0.07960199004975124,0.09950248756218906,0.003980099502487563},
            {0.05970149253731343,0.13930348258706468,0.11940298507462686,0.06965174129353234,0.14925373134328357,0.01990049751243781},
            {0.21890547263681592,0.13930348258706468,0.011940298507462687,0.0318407960199005,0.07462686567164178,0.023880597014925373},
            {0.07960199004975124,0.21890547263681592,0.05472636815920398,0.03980099502487562,0.0318407960199005,0.027860696517412933},
            {0.0318407960199005,0.07960199004975124,0.06467661691542288,0.013333333333333334,0.11940298507462686,0.0463681592039801},
            {0.011940298507462687,0.009950248756218905,0.23880597014925373,0.01990049751243781,0.05970149253731343,0.055721393034825865},
            {0.027860696517412933,0.014925373134328358,0.15920398009950248,0.03482587064676617,0.1791044776119403,0.03323383084577114},
            {0.01990049751243781,0.03980099502487562,0.05174129353233831,0.004975124378109453,0.006567164179104478,0.0318407960199005},
            {0.03980099502487562,0.11940298507462686,0.06965174129353234,0.03980099502487562,0.07462686567164178,0.05970149253731343},
            {0.04776119402985075,0.014925373134328358,0.05313432835820896,0.029850746268656716,0.05970149253731343,0.13930348258706468},
            {0.29850746268656714,0.07462686567164178,0.21890547263681592,0.07960199004975124,0.23880597014925373,0.08955223880597014},
            {0.08616915422885572,0.29850746268656714,0.03980099502487562,0.024875621890547265,0.027860696517412933,0.0318407960199005},
            {0.07303482587064676,0.023880597014925373,0.13930348258706468,0.15920398009950248,0.04975124378109453,0.027860696517412933},
            {0.08616915422885572,0.03482587064676617,0.03980099502487562,0.055721393034825865,0.013333333333333334,0.05970149253731343},
            {0.01592039800995025,0.027860696517412933,0.055721393034825865,0.011940298507462687,0.19900497512437812,0.009950248756218905},
            {0.07462686567164178,0.27860696517412936,0.03980099502487562,0.1791044776119403,0.027860696517412933,0.009950248756218905},
            {0.09950248756218906,0.14925373134328357,0.01990049751243781,0.03582089552238806,0.01990049751243781,0.09293532338308458},
            {0.14925373134328357,0.05970149253731343,0.08955223880597014,0.014925373134328358,0.23880597014925373,0.09950248756218906},
            {0.01990049751243781,0.07960199004975124,0.04975124378109453,0.003980099502487563,0.05313432835820896,0.21890547263681592},
            {0.09950248756218906,0.05313432835820896,0.03582089552238806,0.04975124378109453,0.011940298507462687,0.023880597014925373},
            {0.06965174129353234,0.21890547263681592,0.09293532338308458,0.01990049751243781,0.01990049751243781,0.013333333333333334},
            {0.25870646766169153,0.05472636815920398,0.05174129353233831,0.09950248756218906,0.05970149253731343,0.05970149253731343},
            {0.04776119402985075,0.007960199004975126,0.03482587064676617,0.11940298507462686,0.02646766169154229,0.029850746268656716},
            {0.13930348258706468,0.06467661691542288,0.12935323383084577,0.055721393034825865,0.009950248756218905,0.05970149253731343},
            {0.09293532338308458,0.013333333333333334,0.05313432835820896,0.06965174129353234,0.03980099502487562,0.07960199004975124},
            {0.01990049751243781,0.03980099502487562,0.05970149253731343,0.07462686567164178,0.009950248756218905,0.03980099502487562},
            {0.029850746268656716,0.09293532338308458,0.03482587064676617,0.25870646766169153,0.01990049751243781,0.03980099502487562},
            {0.009950248756218905,0.13930348258706468,0.19900497512437812,0.04477611940298507,0.014925373134328358,0.06467661691542288},
            {0.15920398009950248,0.02646766169154229,0.13930348258706468,0.15920398009950248,0.13930348258706468,0.01990049751243781},
            {0.03980099502487562,0.03980099502487562,0.05970149253731343,0.03482587064676617,0.05970149253731343,0.06965174129353234},
            {0.011940298507462687,0.03323383084577114,0.05970149253731343,0.19900497512437812,0.006567164179104478,0.04477611940298507},
            {0.1791044776119403,0.07462686567164178,0.05313432835820896,0.12935323383084577,0.1791044776119403,0.27860696517412936},
            {0.01990049751243781,0.05970149253731343,0.21890547263681592,0.05970149253731343,0.06965174129353234,0.02646766169154229},
            {0.01990049751243781,0.01592039800995025,0.02646766169154229,0.03980099502487562,0.03980099502487562,0.01592039800995025},
            {0.0463681592039801,0.04975124378109453,0.14925373134328357,0.14925373134328357,0.15920398009950248,0.007960199004975126},
            {0.11940298507462686,0.01592039800995025,0.05970149253731343,0.07960199004975124,0.01990049751243781,0.07303482587064676},
            {0.23880597014925373,0.06467661691542288,0.01990049751243781,0.029850746268656716,0.03980099502487562,0.21890547263681592},
            {0.009950248756218905,0.013333333333333334,0.13930348258706468,0.01990049751243781,0.009950248756218905,0.013333333333333334},
            {0.29850746268656714,0.014925373134328358,0.29850746268656714,0.024875621890547265,0.02646766169154229,0.027860696517412933},
            {0.07960199004975124,0.05970149253731343,0.01592039800995025,0.029850746268656716,0.11940298507462686,0.03323383084577114},
            {0.09293532338308458,0.04378109452736319,0.05970149253731343,0.004975124378109453,0.05970149253731343,0.0318407960199005},
            {0.01990049751243781,0.0318407960199005,0.01990049751243781,0.03980099502487562,0.10945273631840796,0.03482587064676617},
            {0.029850746268656716,0.04378109452736319,0.01990049751243781,0.004975124378109453,0.01990049751243781,0.014925373134328358},
            {0.03980099502487562,0.13930348258706468,0.04975124378109453,0.009950248756218905,0.13930348258706468,0.03980099502487562},
            {0.12935323383084577,0.01990049751243781,0.006567164179104478,0.03980099502487562,0.05472636815920398,0.01990049751243781},
            {0.07960199004975124,0.009950248756218905,0.05970149253731343,0.03980099502487562,0.0662686567164179,0.01990049751243781},
            {0.05970149253731343,0.08955223880597014,0.05472636815920398,0.05970149253731343,0.25870646766169153,0.004975124378109453},
            {0.08616915422885572,0.09950248756218906,0.03980099502487562,0.04776119402985075,0.055721393034825865,0.007960199004975126},
            {0.07960199004975124,0.06467661691542288,0.1791044776119403,0.029850746268656716,0.011940298507462687,0.03482587064676617},
            {0.07303482587064676,0.013333333333333334,0.04975124378109453,0.009950248756218905,0.15920398009950248,0.05970149253731343},
            {0.07960199004975124,0.09950248756218906,0.0463681592039801,0.14925373134328357,0.14925373134328357,0.1791044776119403},
            {0.05970149253731343,0.23880597014925373,0.05970149253731343,0.007960199004975126,0.03980099502487562,0.29850746268656714},
            {0.027860696517412933,0.07303482587064676,0.029850746268656716,0.05970149253731343,0.05313432835820896,0.05174129353233831},
            {0.29850746268656714,0.03980099502487562,0.05970149253731343,0.024875621890547265,0.21890547263681592,0.01990049751243781},
            {0.06965174129353234,0.09293532338308458,0.03980099502487562,0.03980099502487562,0.06965174129353234,0.25870646766169153},
            {0.0318407960199005,0.07960199004975124,0.029850746268656716,0.03980099502487562,0.09950248756218906,0.04378109452736319},
    };

    vector<vector<double>> expectedOutputs = {{0.5486567164179105},{0.21592039800995025},{0.5538308457711443},{0.33373134328358206},{0.26109452736318406},{0.34885572139303483},{0.6234825870646766},{0.6135323383084577},{0.7263681592039801},{0.4284577114427861},{0.26109452736318406},{0.6125373134328358},{0.5781094527363184},{0.4951243781094527},{0.32975124378109455},{0.3522388059701492},{0.30149253731343284},{0.6069651741293532},{0.6049751243781094},{0.6865671641791045},{0.3625870646766169},{0.20756218905472637},{0.1890547263681592},{0.3556218905472637},{0.2746268656716418},{0.5850746268656716},{0.3900497512437811},{0.39542288557213934},{0.46208955223880593},{0.41194029850746267},{0.13532338308457711},{0.591044776119403},{0.3402985074626866},{0.3675621890547263},{0.581094527363184},{0.6666666666666666},{0.5058706467661692},{0.44975124378109455},{0.7389054726368159},{0.2065671641791045},{0.34686567164179105},{0.21731343283582089},{0.27860696517412936},{0.5950248756218905},{0.3854726368159204},{0.5572139303482587},{0.5004975124378109},{0.4527363184079602},{0.35522388059701493},{0.3960199004975124},{0.44915422885572137},{0.15482587064676617},{0.40298507462686567},{0.3446766169154229},{1.0},{0.5090547263681592},{0.47303482587064677},{0.28955223880597014},{0.3203980099502488},{0.6099502487562188},{0.4173134328358209},{0.6517412935323383},{0.42527363184079603},{0.2740298507462686},{0.4344278606965174},{0.5840796019900498},{0.2662686567164179},{0.45870646766169154},{0.3482587064676617},{0.24378109452736318},{0.47601990049751247},{0.472636815920398},{0.6433830845771144},{0.3034825870646766},{0.35522388059701493},{0.8939303482587065},{0.4543283582089552},{0.15781094527363185},{0.5617910447761194},{0.3675621890547263},{0.6119402985074627},{0.2055721393034826},{0.6911442786069651},{0.3377114427860696},{0.2929353233830846},{0.2557213930348259},{0.13333333333333333},{0.417910447761194},{0.2702487562189055},{0.2752238805970149},{0.527363184079602},{0.33691542288557214},{0.4},{0.36477611940298504},{0.7030845771144278},{0.7044776119402985},{0.29512437810945275},{0.6616915422885572},{0.570547263681592},{0.3243781094527363}};

    vector<unsigned> topology{6, 6, 1};

    NetworkTrainer trainer;
    LearningResult res = trainer.trainNetwork(topology, trainingSets, expectedOutputs, 100000, 0.005);

    cout << "Epochs passed: " << res.epochsPassed << endl;
    cout << "Average error: " << res.averageError << endl;

    cout << endl << "Done" << endl;

    return 0;
}